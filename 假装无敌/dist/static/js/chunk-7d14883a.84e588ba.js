(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7d14883a"],{"0962":function(e,t,n){},1440:function(e,t,n){"use strict";n("0962")},"18fe":function(e,t,n){"use strict";(function(e){var r=n("c7eb"),a=n("1da1"),i=(n("ac1f"),n("00b4"),n("466d"),n("d3b7"),n("25f0"),n("ace4"),n("5cc6"),n("907a"),n("9a8c"),n("a975"),n("735e"),n("c1ac"),n("d139"),n("3a7b"),n("986a"),n("1d02"),n("d5d6"),n("82f8"),n("e91f"),n("60bd"),n("5f96"),n("3280"),n("3fcc"),n("ca91"),n("25a1"),n("cd26"),n("3c5d"),n("2954"),n("649e"),n("219c"),n("170b"),n("b39a"),n("72f7"),n("caad"),n("2532"),n("14d9"),n("b0c0"),n("d81d"),n("99af"),n("38cf"),n("4de4"),n("d9e2"),n("a630"),n("3ca3"),n("6062"),n("ddb0"),n("5319"),n("a15b"),n("159b"),n("0481"),n("4069"),n("b64b"),n("fb6a"),n("b680"),n("31fa")),s=n("2760"),o=n("2ef0");t["a"]={name:"unzip",components:{Terminal:i["a"]},data:function(){return{name:"unzip-terminal",isMobile:/(nokia|iphone|android|ipad|motorola|^mot\-|softbank|foma|docomo|kddi|up\.browser|up\.link|htc|dopod|blazer|netfront|helio|hosin|huawei|novarra|CoolPad|webos|techfaith|palmsource|blackberry|alcatel|amoi|ktouch|nexian|samsung|^sam\-|s[cg]h|^lge|ericsson|philips|sagem|wellcom|bunjalloo|maui|symbian|smartphone|midp|wap|phone|windows ce|iemobile|^spice|^bird|^zte\-|longcos|pantech|gionee|^sie\-|portalmmm|jig\s browser|hiptop|^ucweb|^benq|haier|^lct|opera\s*mobi|opera\*mini|320x320|240x320|176x220)/i.test(navigator.userAgent),initLog:[{type:"normal",content:"Terminal Initializing ..."},{type:"normal",content:"Current login time: "+(new Date).toLocaleString()},{tag:"识别操作系统",type:"normal",class:"success",content:function(){var e,t=navigator.userAgent.toString().match(/\s[\s\w]+/);return e=null!=t?t[0]:navigator.platform,"当前操作系统：".concat(e)}()},{tag:"挖坑待填",type:"normal",class:"system",content:"当前为单线程操作包括通知信息，后续将解析、解压等操作程移植到其它线程上，并可以自动解析扩展等，保证更加全面，更加及时通知。"}],context:"清瑶解压缩",SevenZip:null,replaceStr:"",readOnly:!1,commandStore:[{key:"load",title:"加载压缩包",group:"zip",usage:"load [src]",description:"加载本地压缩包",example:[{des:"加载压缩包",cmd:"load D:/User/Noname/假装无敌.rar"},{des:"使用7za去加载压缩包，目前已知支持 .7z,.zip,.rar,.gzip,.tar等，7z能解压的都能解压",cmd:""}]},{key:"ls",title:"显示压缩包里面的文件",usage:"ls",description:"显示压缩包里面的文件",example:[{des:"显示压缩包里面的文件，前提需要使用load加载压缩包"}]},{key:"autoDestPath",title:"自动解析该压缩包解压位置",usage:"autoDestPath",description:"自动解析该压缩包解压位置，需要先调用load方法加载压缩包"},{key:"unZipEntry",title:"使用解压流程",usage:"unZipEntry [zipSrc]",description:"自动加载该压缩包并解压到对应的位置，目前暂时只支持完整包和数据包，解压路径会输出日志，请关注！"}]}},beforeCreate:function(){e.isBuffer=function(e){return e instanceof parent.Uint8Array||!(null==e||!e._isBuffer)||e instanceof window.Uint8Array}},created:function(){var e=location,t=e.href;decodeURIComponent(t).includes("假装无敌")?this.initLog.push({tag:"已安装假装无敌",type:"normal",class:"success",content:"解压过程中若遇到了bug请先试着翻译异常信息"}):this.initLog.push({tag:"未安装",type:"normal",class:"warning",content:'此界面依赖扩展<font color="#f39c12">【假装无敌】</font>，想体验完整功能，请在<font color="#f39c12">【假装无敌】</font>打开此界面'})},mounted:function(){var e=this;if(window.lib||(window.lib={}),this.isMobile)return this.addMessage('移动端请使用功能强大的<a class="qingyao" href="https://pd.qq.com/s/7k171gh8b?shareSource=5" target=\'_blank\'>清瑶版</a><font color="#dc143c">群号：314590231</font>！此功能在移动端无效',null,"error");try{Object.assign(window.lib,{node:{fs:parent.require("fs")}})}catch(s){return this.addMessage("加载文件模块失败！",null,"error")}var t=this.$route.query,n=t.zipPath,r=t.node7Zip,a=t.isDebug;return n?lib.node.fs.existsSync(n)?(requestAnimationFrame((function(){return e.extractTask(n,r,a).catch((function(t){console.error(t),e.addMessage(t.systemError||t.toString(),null,"error")}))})),void(this.readOnly=!0)):i["a"].$api.pushMessage(this.name,{type:"normal",class:"error",content:"文件不存在，请检查！"}):this.addMessage("请输入help查看可以使用的命令")},methods:{addMessage:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"normal",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"system",r=arguments.length>3?arguments[3]:void 0;e&&i["a"].$api.pushMessage(this.name,{type:t,class:n,content:e,tag:r})},onExecCmd:function(e,t,n,o){var c=this;if(!parent.require)return o("没有node环境");switch(e){case"load":var u=t.split(" ")[1];if(!u)return o("请填写文件路径！");lib.node.fs.exists(u,(function(e){if(!e)return o("文件不存在，请检查路径");c.SevenZip=new s["b"](u,parent.require("".concat(window.__dirname,"/extension/假装无敌/node7zip-bin"))["path7za"],!1),n("加载完毕")}));break;case"ls":if(null===this.SevenZip)return o("文件加载失败");var l=new i["a"].$Flash;n(l),this.SevenZip.listFile((function(e){var t=e.percent;c.mockLoading(l,"正在加载压缩包文件",t)})).then((function(e){l.finish(),console.log(e),n(e.map((function(e){return e.file})).toString())})).catch((function(e){l.finish(),o("加载异常：".concat(e.toString(),"<br/>systemError:").concat(e.systemError||e.toString())),console.error(e)}));break;case"autoDestPath":if(null===this.SevenZip)return o("文件加载失败");this.SevenZip.listFile().then(function(){var e=Object(a["a"])(Object(r["a"])().mark((function e(t){return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return console.log(t),e.t0=n,e.next=4,c.getDestFullPath(t);case 4:e.t1=e.sent,(0,e.t0)(e.t1);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){o("加载异常：".concat(e.toString(),"<br/>systemError:").concat(e.systemError||e.toString())),console.error(e)}));break;case"unZipEntry":var h=t.split(" ")[1];if(!lib.node.fs.existsSync(h))return o("未找到压缩包位置！");requestAnimationFrame((function(){c.extractTask(h,parent.require("".concat(window.__dirname,"/extension/假装无敌/node7zip-bin"))["path7za"],!1).catch((function(e){console.error(e),c.addMessage(e.systemError||e.toString(),null,"error")}))}));break;default:o("unknown command");break}},mockLoading:function(e,t,n){var r=i["a"].$api.elementInfo(this.name),a=15+(6+t.length)*r.charWidth.en,s=(r.clientWidth-a)/r.charWidth.en,o='<span class="loading-flash" style="transform: rotate(',c='deg)"></span><span style="color: aqua">'.concat(t,"</span>[");n=Math.min(Math.floor(n),100);var u=Math.min(Math.floor(100*n/s),100);u<10?u="  "+u:u<100&&(u=" "+u);var l=o+n%8*90+c+"#".repeat(n)+"-".repeat(Math.max(s-n,0))+"]"+u+"%";e.flush(l)},extractTask:function(e,t,n){var o=this;return Object(a["a"])(Object(r["a"])().mark((function a(){var c,u,l,h;return Object(r["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return o.SevenZip=new s["b"](e,t,n),c=new i["a"].$Flash,i["a"].$api.success(o.name,c),r.next=5,o.SevenZip.listFile((function(e){var t=e.percent;return o.mockLoading(c,"正在加载压缩包文件",t)}));case 5:return u=r.sent,c.finish(),o.addMessage("正在检测文件是否加密，并设置上密码"),r.next=10,o.SevenZip.checkGetPassword();case 10:return l=r.sent,null!==l&&o.addMessage("输入的密码为：".concat(l)),o.addMessage("开始解析文件类型，以及对应的解压目录！"),o.addMessage("当前路径：".concat(window.__dirname)),r.next=16,o.getDestFullPath(u);case 16:return h=r.sent,o.addMessage("解析解压路径：".concat(h)),r.next=20,o.unZipToDestPath(h,u);case 20:case"end":return r.stop()}}),a)})))()},parseExtensionName:function(e){var t=this;return Object(a["a"])(Object(r["a"])().mark((function n(){var a;return Object(r["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(a=e.filter((function(e){return Object(o["endsWith"])(e.file,"extension.js")})),a.length){n.next=3;break}throw new Error("该压缩包缺少扩展主要文件extension.js");case 3:if(!a.every((function(e){return e.split("/").length>1}))){n.next=7;break}return Array.from(new Set(a.map((function(e){return e.split("/")[0]})))),t.addMessage("压缩包名称为：".concat(a.toString())),n.abrupt("return","extension");case 7:return t.addMessage("正在解析扩展名称"),n.abrupt("return",[]);case 9:case"end":return n.stop()}}),n)})))()},getDestFullPath:function(e){var t=this;return Object(a["a"])(Object(r["a"])().mark((function n(){var a,i,s;return Object(r["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(t.addMessage("优先识别是否【数据包】"),a=[parent.__dirname,"/"],i=e.filter((function(e){return Object(o["endsWith"])(e.file,"game/game.js")})),!i.length){n.next=9;break}t.addMessage("此压缩包是【数据包】"),s=i[0].file.replace("game/game.js",""),""!==s&&(t.addMessage("已自动识别里面还有目录：".concat(s)),t.replaceStr=s),n.next=10;break;case 9:throw new Error("此压缩包不是【数据包】，如为扩展包请使用【快捷导入】！");case 10:return n.abrupt("return",a.join(""));case 11:case"end":return n.stop()}}),n)})))()},unZipToDestPath:function(e,t){var n=this,r={};t.map((function(e){return[e.techInfo,e.file.replace(n.replaceStr,"")]})).filter((function(e){return e[0]&&e[1]})).forEach((function(e){var t=e[0].get("Folder");if(!t||"+"!==t){var a=new s["a"](e[1]);if(a.getName().includes(".")){var i=a.getParent();null===i&&(i=""),r[i]||(r[i]=[]),r[i].push(n.replaceStr+e[1])}}}));var a=Object.keys(r).map((function(t){(new Date).getTime();var a=new i["a"].$Flash;i["a"].$api.success(n.name,a);var s=r[t];if(s.length>800){for(var o=s,c=Math.ceil(o.length/800),u=[],l=0;l<c;l++)u.push(o.slice(800*l,800*(l+1)));return u.map((function(t){return n.extractFile(t,e+t,t,s,e+t,a)}))}return n.extractFile(t,s,e+t,a)})).flat(window.Infinity),o=(new Date).getTime();return Promise.all(a).then((function(e){var t=(((new Date).getTime()-o)/1e3).toFixed(2);return n.addMessage("✔︎  全部解压完毕! 耗时：<span>".concat(t,"</span> s"),null,"success","解压完成"),!0}))},extractFile:function(e,t,n,r){var a=this,i=(new Date).getTime();return this.SevenZip.extractFile(t,n,(function(t){var n=t.percent;return a.mockLoading(r,e,n)})).then((function(){r.finish();var t=(((new Date).getTime()-i)/1e3).toFixed(2);console.log("解压完毕："+e,t+"s"),a.addMessage(' ✅ <span style="color: aqua">'.concat(e,"</span> 解压完成! 耗时：<span>").concat(t,"</span> s"))})).catch((function(t){r.finish(),a.addMessage(' ❌︎ <span style="color: #ff0000">'.concat(e,"</span> 解压异常： ").concat(t.systemError||t.toString(),"</span>"),null,"error"),console.error(e,t)}))}}}}).call(this,n("b639").Buffer)},2760:function(e,t,n){"use strict";n.d(t,"b",(function(){return y})),n.d(t,"a",(function(){return k}));var r=n("c7eb"),a=n("1da1"),i=n("d4ec"),s=n("bee2"),o=n("d5e4"),c=n("ade3"),u=n("5364"),l=(n("d9e2"),n("4de4"),n("d3b7"),n("7db0"),n("14d9"),n("a15b"),n("3ca3"),n("10d1"),n("ddb0"),n("0f04")),h=n.n(l),f=n("4d4a"),d=n("5c96"),p=n("b518"),g=p.enabled,m=p.enable,b=p.disable,v=Object.assign,w=function(e){var t=parent.require("child_process"),n=t.spawn,r=Object.assign({detached:!0,windowsHide:!0},e._spawnOptions);return e._childProcess=n(e._bin,e._args,r),e},x=new WeakMap,y=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(Object(i["a"])(this,e),Object(c["a"])(this,"originPath",""),Object(o["a"])(this,x,{writable:!0,value:[]}),Object(c["a"])(this,"options",{$defer:!0,$bin:this.path7za,$progress:!0,recursive:!0,techInfo:!0,password:"",overwrite:"a",listFileCharset:"UTF-8",onerror:function(e){}}),!Object(f["isString"])(t))throw new Error("源文件路径必须是String类型");if(!Object(f["isString"])(n))throw new Error("7za路径必须是String类型");this.originPath=t,this.options.$bin=n,"false"!==r&&r?g("node-7z")||m("node-7z"):(b("node-7z"),localStorage.removeItem("debug"))}return Object(s["a"])(e,[{key:"checkGetPassword",value:function(){var e=Object(a["a"])(Object(r["a"])().mark((function e(){var t;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.checkPassword();case 2:if(t=e.sent,!t){e.next=7;break}return e.next=6,this.setPassword();case 6:return e.abrupt("return",e.sent);case 7:return e.abrupt("return",null);case 8:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"checkPassword",value:function(){var e=Object(a["a"])(Object(r["a"])().mark((function e(){var t,n;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.listFile();case 2:return t=e.sent,n=t.filter((function(e){var t=e.techInfo.get("Encrypted");return"+"===t})),e.abrupt("return",n.length>0);case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"listFile",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(e){};return Object(u["a"])(this,x).length>0?Promise.resolve(Object(u["a"])(this,x)):new Promise((function(n,r){var a=h.a.list(e.originPath,e.options).on("progress",(function(e){return t(e)})).on("error",(function(e){return r({systemError:e.stderr,err:e})})).on("data",(function(t){null==Object(u["a"])(e,x).find((function(e){return e.file===t.file}))?Object(u["a"])(e,x).push(t):console.error("已经添加过：",t)})).on("end",(function(){return n(Object(u["a"])(e,x))}));w(a),h.a.listen(a)}))}},{key:"setPassword",value:function(){var e=this;return new Promise((function(t,n){d["MessageBox"].prompt("请输入压缩包密码","系统提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"info"}).then((function(n){var r=n.value;e.options.password=r,t(r)})).catch((function(){return t(null)}))}))}},{key:"extractFile",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(e){};return new Promise((function(a,i){var s=h.a.extract(n.originPath,t,v(n.options,{$cherryPick:e})).on("error",(function(e){console.error(e.stderr),console.error(e),i(e)})).on("progress",(function(e){return r(e)})).on("end",(function(){return a(!0)}));w(s),h.a.listen(s)}))}}]),e}(),k=function(){function e(t){Object(i["a"])(this,e),Object(c["a"])(this,"separatorChar","/"),Object(c["a"])(this,"pathname",""),Object(c["a"])(this,"path",""),this.pathname=t,this.path=this.normalize(t),this.prefixLength=this._prefixLength(this.path)}return Object(s["a"])(e,[{key:"getPath",value:function(){return this.path}},{key:"getName",value:function(){var e=this.pathname.lastIndexOf(this.separatorChar);return e<this.prefixLength?this.pathname.substring(this.prefixLength):this.pathname.substring(e+1)}},{key:"_prefixLength",value:function(e){return Object(f["isEmpty"])(e)?0:"/"===e.charAt(0)?1:0}},{key:"normalize",value:function(e){for(var t=e.length,n=0,r=0;r<t;r++){var a=e.charAt(r);if("/"===n&&"/"===a)return this.normalizex(e,t,r-1);n=a}return"/"===n?this.normalizex(e,t,t-1):e}},{key:"normalizex",value:function(e,t,n){if(0===t)return e;var r=t;while(r>0&&"/"===e.charAt(r-1))r--;if(0===r)return"/";var a=[];n>0&&a.push(e.substring(0,n));for(var i=0,s=n;s<r;s++){var o=e.charAt(s);"/"===i&&"/"===o||(a.append(o),i=o)}return a.join("")}},{key:"getParent",value:function(){var e=this.path.lastIndexOf(this.separatorChar);return e<this.prefixLength?this.prefixLength>0&&this.path.length>this.prefixLength?this.path.substring(0,this.prefixLength):null:this.path.substring(0,e)}}]),e}()},3:function(e,t){},4:function(e,t){},"45f5":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"app-container"},[n("terminal",{attrs:{name:e.name,context:e.context,"show-header":!1,"init-log":e.initLog,"read-only":e.readOnly,terminal:!0,commandStore:e.commandStore},on:{execCmd:e.onExecCmd}})],1)},a=[],i=n("18fe"),s=i["a"],o=(n("1440"),n("2877")),c=Object(o["a"])(s,r,a,!1,null,"d85d3ae8",null);t["default"]=c.exports}}]);