(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3c3a81c3"],{"21a4":function(e,_,t){e.exports=t.p+"static/img/qie_complete.8ae85a11.gif"},2421:function(e,_,t){"use strict";t("d3b7"),t("ac1f"),t("5319"),t("fb6a"),t("25f0"),t("99af");var r=t("bc3a"),s=t.n(r),o=t("81ae"),a=t("ed08"),n=s.a.create({timeoutErrorMessage:"请求超时",timeout:1e4,validateStatus:function(e){return e>=200&&e<300||0===e}});n.interceptors.request.use((function(e){return e}),(function(e){return console.log(e),Promise.reject(e)})),n.interceptors.response.use((function(e){var _=e.config,t=_.baseURL,r=_.url;return e.filename=Object(a["g"])(r),e.filefullname=r.replace(t,""),e.filepath=e.filefullname.replace(e.filename,""),Promise.resolve(e)}),(function(e){var _=e.response;if(e.isAxiosError&&_){var t=_.status,r=_.data,s=_.config,n=s.baseURL,i=s.url;return _.id=Math.random().toString(16).slice(2),_.filefullname=i.replace(n,""),_.filename=Object(a["g"])(i),_.message=o["b"][t]||"".concat(o["b"]["default"]," ").concat(t," ").concat(r),Promise.reject(_)}return e.message=e.message||"请求失败",console.error(e),Promise.reject(e)})),_["a"]=n},"31d1":function(e,_,t){"use strict";t.r(_);var r=function(){var e=this,_=e.$createElement,t=e._self._c||_;return t("div",{staticClass:"app-container"},[t("downloadGameFile")],1)},s=[],o=function(){var e=this,_=this,t=_.$createElement,r=_._self._c||t;return r("div",[r("el-form",{attrs:{model:_.formData,"label-width":"100px",size:"medium"}},[r("el-row",{staticClass:"mb8",attrs:{gutter:15}},[r("el-col",{attrs:{span:12}},[r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{label:"点击检查更新",prop:"checkForUpdate"}},[r("el-dropdown",{directives:[{name:"loading",rawName:"v-loading",value:_.formData.loading,expression:"formData.loading"}],staticStyle:{"margin-left":"10px"},attrs:{disabled:_.formData.disable,size:"small","split-button":"",type:"primary"},on:{click:function(e){return _.execCommand(_.formData.checkForUpdate)},command:_.handleCommand}},[_._v(" "+_._s(_.checkForUpdateOptions[_.formData["checkForUpdate"]])+" "),r("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},_._l(_.checkForUpdateOptions,(function(e,t){return r("el-dropdown-item",{key:t,attrs:{command:t}},[_._v(_._s(e)+" ")])})),1)],1)],1)],1),r("el-col",{attrs:{span:24}},[r("el-button",{attrs:{icon:"el-icon-setting",plain:"",type:"primary"},on:{click:function(e){_.formData.outerVisible=!0}}},[_._v("管理地址 ")])],1)],1),r("el-col",{attrs:{span:12}},[r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{label:"显示进度条",prop:"progress"}},[r("el-switch",{attrs:{"active-color":"#13CE66","inactive-color":"#FF0000"},model:{value:_.formData.progress,callback:function(e){_.$set(_.formData,"progress",e)},expression:"formData.progress"}})],1)],1),r("el-col",{attrs:{span:18}},[r("el-form-item",{attrs:{label:"下载地址",prop:"downloadURL"}},[r("el-select",{style:{width:"100%"},attrs:{placeholder:"请选择地址下载"},on:{change:_.changeDownloadURL},model:{value:_.formData.downloadURL,callback:function(e){_.$set(_.formData,"downloadURL",e)},expression:"formData.downloadURL"}},_._l(_.downloadURLOptions.concat(_.formData.downloadURLOptions),(function(e,_){return r("el-option",{key:_,attrs:{disabled:e.disabled,label:e.label,value:e.value}})})),1)],1)],1)],1),_.formData.progress?r("el-col",{attrs:{span:24}},[_.formData.progress?r("div",[r("el-divider",[_._v("进度条")]),r("el-image",{staticStyle:{width:"120px"},style:{left:_.qieBodyProgress+"%",transition:"left 0.6s ease"},attrs:{src:_.qieBodyImage,alt:"企鹅"}}),r("el-form-item",{attrs:{label:"本体总进度"}},[r("el-progress",{staticStyle:{width:"90%","margin-top":"10px"},attrs:{color:_.progress.customColors,percentage:_.progressBodyLoaded,"stroke-width":20,"text-inside":!0}}),_._v(" "+_._s(_.progress.body.loaded)+" / "+_._s(_.progress.body.total)+" ")],1),r("el-image",{staticStyle:{width:"120px"},style:{left:_.qieResourcesProgress+"%",transition:"left 0.6s ease"},attrs:{src:_.qieResourcesImage,alt:"企鹅"}}),r("el-form-item",{attrs:{label:"素材总进度"}},[r("el-progress",{staticStyle:{width:"90%","margin-top":"10px"},attrs:{color:_.progress.customColors,percentage:_.progressResourcesLoaded,"stroke-width":20,"text-inside":!0}}),_._v(" "+_._s(_.progress.resources.loaded)+" / "+_._s(_.progress.resources.total)+" ")],1),_._l(_.progress.data,(function(e,t){return r("el-form-item",{key:t,staticStyle:{"word-break":"break-word"},attrs:{label:e.label,prop:"progress"}},[r("el-progress",{staticStyle:{width:"90%","margin-top":"10px"},attrs:{color:_.progress.customColors,percentage:e.percentage,"stroke-width":20,"text-inside":!0}}),e.text?r("span",[_._v(" "+_._s(e.text))]):_._e()],1)}))],2):_._e()]):_._e()],1)],1),r("el-dialog",{directives:[{name:"dialog-drag",rawName:"v-dialog-drag"}],attrs:{visible:_.formData.outerVisible,"append-to-body":"",title:"管理地址"},on:{"update:visible":function(e){return _.$set(_.formData,"outerVisible",e)}}},[r("el-row",{staticClass:"mb8",attrs:{gutter:10}},[r("el-col",{attrs:{span:1.5}},[r("el-button",{attrs:{icon:"el-icon-plus",plain:"",type:"primary"},on:{click:function(){_.formData.innerVisible=!0,e.addFormData={}}}},[_._v("新增地址 ")])],1)],1),r("el-table",{attrs:{data:_.downloadURLOptions.concat(_.formData.downloadURLOptions)}},[r("el-table-column",{attrs:{label:"显示",property:"label",width:"150"}}),r("el-table-column",{attrs:{label:"地址值",property:"value",width:"auto"}}),r("el-table-column",{attrs:{label:"操作",property:"edit"},scopedSlots:_._u([{key:"default",fn:function(e){return[_.downloadURLOptions.includes(e.row)?_._e():r("el-button",{attrs:{icon:"el-icon-edit",size:"mini",type:"text"},on:{click:function(t){return _.handleUpdate(e.row)}}},[_._v("修改 ")]),_.downloadURLOptions.includes(e.row)?_._e():r("el-button",{attrs:{icon:"el-icon-delete",size:"mini",type:"text"},on:{click:function(t){return _.handleDelete(e.row)}}},[_._v("删除 ")])]}}])})],1),r("el-dialog",{directives:[{name:"dialog-drag",rawName:"v-dialog-drag"}],attrs:{visible:_.formData.innerVisible,"append-to-body":"",title:"新增地址"},on:{"update:visible":function(e){return _.$set(_.formData,"innerVisible",e)},close:function(){return _.formData.updateInputLabelDisable=!1}}},[r("el-form",{ref:"elForm",attrs:{model:_.addFormData,rules:_.rules}},[r("el-form-item",{attrs:{label:"地址名称",prop:"label"}},[r("el-input",{attrs:{disabled:_.formData.updateInputLabelDisable,autocomplete:"off",placeholder:"coding"},model:{value:_.addFormData.label,callback:function(e){_.$set(_.addFormData,"label",e)},expression:"addFormData.label"}})],1),r("el-form-item",{attrs:{label:"地址值",prop:"value"}},[r("el-input",{attrs:{autocomplete:"off",placeholder:"https://nakamurayuri.coding.net/p/noname/d/noname/git/raw/master/","prefix-icon":"el-icon-link"},model:{value:_.addFormData.value,callback:function(e){_.$set(_.addFormData,"value",e)},expression:"addFormData.value"}},[r("template",{slot:"append"},[_._v("game/update.js")])],2)],1)],1),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(e){_.formData.innerVisible=!1}}},[_._v("取 消")]),r("el-button",{directives:[{name:"loading",rawName:"v-loading",value:_.formData.handleAddLoading,expression:"formData.handleAddLoading"}],attrs:{type:"primary"},on:{click:_.handleAdd}},[_._v("确 定")])],1)],1)],1),r("el-dialog",{attrs:{"close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1,visible:_.formData.innerFileVisible,"append-to-body":"",title:"指定文件更新"},on:{"update:visible":function(e){return _.$set(_.formData,"innerFileVisible",e)},close:function(){return _.formData.innerFileVisible=!1}}},[r("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:_.updateFileList,"tooltip-effect":"dark"},on:{"selection-change":_.handleSelectionChange}},[r("el-table-column",{attrs:{type:"selection",width:"55"}}),r("el-table-column",{attrs:{label:"文件名称",prop:"label"}})],1),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{type:"primary"},on:{click:_.dialogFileResolve}},[_._v("确 定")])],1)],1)],1)},a=[],n=t("35c9"),i=n["a"],l=t("2877"),c=Object(l["a"])(i,o,a,!1,null,"0058e179",null),u=c.exports,d={name:"downloadFile",components:{downloadGameFile:u}},m=d,p=Object(l["a"])(m,r,s,!1,null,"0121bfde",null);_["default"]=p.exports},"35c9":function(module,__webpack_exports__,__webpack_require__){"use strict";var _Users_noname_UI_node_modules_babel_runtime_helpers_esm_regeneratorRuntime_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("c7eb"),_Users_noname_UI_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("1da1"),_Users_noname_UI_node_modules_babel_runtime_helpers_esm_toConsumableArray_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("2909"),core_js_modules_es_array_push_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("14d9"),core_js_modules_es_array_push_js__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(core_js_modules_es_array_push_js__WEBPACK_IMPORTED_MODULE_3__),core_js_modules_es_array_slice_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("fb6a"),core_js_modules_es_array_slice_js__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(core_js_modules_es_array_slice_js__WEBPACK_IMPORTED_MODULE_4__),core_js_modules_es_object_to_string_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("d3b7"),core_js_modules_es_object_to_string_js__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(core_js_modules_es_object_to_string_js__WEBPACK_IMPORTED_MODULE_5__),core_js_modules_es_regexp_to_string_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("25f0"),core_js_modules_es_regexp_to_string_js__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(core_js_modules_es_regexp_to_string_js__WEBPACK_IMPORTED_MODULE_6__),core_js_modules_es_array_map_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("d81d"),core_js_modules_es_array_map_js__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(core_js_modules_es_array_map_js__WEBPACK_IMPORTED_MODULE_7__),core_js_modules_es_array_filter_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("4de4"),core_js_modules_es_array_filter_js__WEBPACK_IMPORTED_MODULE_8___default=__webpack_require__.n(core_js_modules_es_array_filter_js__WEBPACK_IMPORTED_MODULE_8__),core_js_modules_es_object_keys_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("b64b"),core_js_modules_es_object_keys_js__WEBPACK_IMPORTED_MODULE_9___default=__webpack_require__.n(core_js_modules_es_object_keys_js__WEBPACK_IMPORTED_MODULE_9__),core_js_modules_es_array_find_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("7db0"),core_js_modules_es_array_find_js__WEBPACK_IMPORTED_MODULE_10___default=__webpack_require__.n(core_js_modules_es_array_find_js__WEBPACK_IMPORTED_MODULE_10__),core_js_modules_es_array_includes_js__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("caad"),core_js_modules_es_array_includes_js__WEBPACK_IMPORTED_MODULE_11___default=__webpack_require__.n(core_js_modules_es_array_includes_js__WEBPACK_IMPORTED_MODULE_11__),core_js_modules_es_array_join_js__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("a15b"),core_js_modules_es_array_join_js__WEBPACK_IMPORTED_MODULE_12___default=__webpack_require__.n(core_js_modules_es_array_join_js__WEBPACK_IMPORTED_MODULE_12__),core_js_modules_es_array_from_js__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("a630"),core_js_modules_es_array_from_js__WEBPACK_IMPORTED_MODULE_13___default=__webpack_require__.n(core_js_modules_es_array_from_js__WEBPACK_IMPORTED_MODULE_13__),core_js_modules_es_string_iterator_js__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__("3ca3"),core_js_modules_es_string_iterator_js__WEBPACK_IMPORTED_MODULE_14___default=__webpack_require__.n(core_js_modules_es_string_iterator_js__WEBPACK_IMPORTED_MODULE_14__),core_js_modules_es_set_js__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__("6062"),core_js_modules_es_set_js__WEBPACK_IMPORTED_MODULE_15___default=__webpack_require__.n(core_js_modules_es_set_js__WEBPACK_IMPORTED_MODULE_15__),core_js_modules_web_dom_collections_iterator_js__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__("ddb0"),core_js_modules_web_dom_collections_iterator_js__WEBPACK_IMPORTED_MODULE_16___default=__webpack_require__.n(core_js_modules_web_dom_collections_iterator_js__WEBPACK_IMPORTED_MODULE_16__),core_js_modules_es_array_concat_js__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__("99af"),core_js_modules_es_array_concat_js__WEBPACK_IMPORTED_MODULE_17___default=__webpack_require__.n(core_js_modules_es_array_concat_js__WEBPACK_IMPORTED_MODULE_17__),core_js_modules_es_array_splice_js__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__("a434"),core_js_modules_es_array_splice_js__WEBPACK_IMPORTED_MODULE_18___default=__webpack_require__.n(core_js_modules_es_array_splice_js__WEBPACK_IMPORTED_MODULE_18__),core_js_modules_es_string_includes_js__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__("2532"),core_js_modules_es_string_includes_js__WEBPACK_IMPORTED_MODULE_19___default=__webpack_require__.n(core_js_modules_es_string_includes_js__WEBPACK_IMPORTED_MODULE_19__),core_js_modules_es_string_ends_with_js__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__("8a79"),core_js_modules_es_string_ends_with_js__WEBPACK_IMPORTED_MODULE_20___default=__webpack_require__.n(core_js_modules_es_string_ends_with_js__WEBPACK_IMPORTED_MODULE_20__),core_js_modules_es_regexp_exec_js__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__("ac1f"),core_js_modules_es_regexp_exec_js__WEBPACK_IMPORTED_MODULE_21___default=__webpack_require__.n(core_js_modules_es_regexp_exec_js__WEBPACK_IMPORTED_MODULE_21__),core_js_modules_es_string_replace_js__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__("5319"),core_js_modules_es_string_replace_js__WEBPACK_IMPORTED_MODULE_22___default=__webpack_require__.n(core_js_modules_es_string_replace_js__WEBPACK_IMPORTED_MODULE_22__),core_js_modules_es_error_cause_js__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__("d9e2"),core_js_modules_es_error_cause_js__WEBPACK_IMPORTED_MODULE_23___default=__webpack_require__.n(core_js_modules_es_error_cause_js__WEBPACK_IMPORTED_MODULE_23__),core_js_modules_es_string_trim_js__WEBPACK_IMPORTED_MODULE_24__=__webpack_require__("498a"),core_js_modules_es_string_trim_js__WEBPACK_IMPORTED_MODULE_24___default=__webpack_require__.n(core_js_modules_es_string_trim_js__WEBPACK_IMPORTED_MODULE_24__),core_js_modules_es_array_find_index_js__WEBPACK_IMPORTED_MODULE_25__=__webpack_require__("c740"),core_js_modules_es_array_find_index_js__WEBPACK_IMPORTED_MODULE_25___default=__webpack_require__.n(core_js_modules_es_array_find_index_js__WEBPACK_IMPORTED_MODULE_25__),_components_Download_request__WEBPACK_IMPORTED_MODULE_26__=__webpack_require__("2421"),lodash_lang__WEBPACK_IMPORTED_MODULE_27__=__webpack_require__("4d4a"),lodash_lang__WEBPACK_IMPORTED_MODULE_27___default=__webpack_require__.n(lodash_lang__WEBPACK_IMPORTED_MODULE_27__),_components_Download_multiDownload__WEBPACK_IMPORTED_MODULE_28__=__webpack_require__("3640");__webpack_exports__["a"]={name:"downloadGameFile",components:{},props:[],created:function(){_components_Download_request__WEBPACK_IMPORTED_MODULE_26__["a"].defaults.baseURL=this.parentPath,window.addEventListener("message",this.onmessage);var e,_=this.$cache.local.getJSON("download - options");Object(lodash_lang__WEBPACK_IMPORTED_MODULE_27__["isArray"])(_)&&(e=this.formData.downloadURLOptions).push.apply(e,Object(_Users_noname_UI_node_modules_babel_runtime_helpers_esm_toConsumableArray_js__WEBPACK_IMPORTED_MODULE_2__["a"])(_))},data:function(){return{id:"",rules:{label:[{required:!0,message:"请输入显示名称",trigger:"blur"},{trigger:"blur",validator:this.checkDownloadLabelUnique,message:"重复的名称,这会导致你无法分辨"}],value:[{required:!0,message:"请输入地址",trigger:"blur"},{pattern:/^http(s)?:\/\//,message:"http(s)://地址错误",trigger:"blur"},{trigger:"blur",validator:this.checkDownloadValueUnique,message:"重复的地址值,这会导致程序异常"}]},addFormData:{label:"",value:""},formData:{innerFileVisible:!1,outerVisible:!1,innerVisible:!1,bodyDisable:!1,resourcesDisable:!1,loading:!1,progress:!0,downloadURL:"https://ghproxy.com/https://raw.githubusercontent.com/libccy/noname/master/",checkForUpdate:"body",downloadURLOptions:[],handleAddLoading:!1,updateInputLabelDisable:!1},version:"",progress:{body:{total:0,loaded:0},resources:{total:0,loaded:0},customColors:[{color:"#f56c6c",percentage:20},{color:"#e6a23c",percentage:40},{color:"#1989fa",percentage:60},{color:"#6f7ad3",percentage:80},{color:"#5cb87a",percentage:100}]},multipleSelection:[],errorRequestNum:0,errorRequestNumResources:0,downloadFileError:{},downloadFiles:{},checkForUpdateOptions:{body:"本体更新",resources:"素材更新"},downloadURLOptions:[{label:"GitHub镜像1(推荐)",value:"https://ghproxy.com/https://raw.githubusercontent.com/libccy/noname/master/"},{label:"GitHub镜像2",value:"https://raw.nuaa.cf/libccy/noname/master/"},{label:"gitlab",value:"https://gitlab.com/zhaiyanqi929/noname/-/raw/master"},{label:"github",value:"https://raw.githubusercontent.com/libccy/noname/master/"}],updateFileList:[]}},computed:{progressBodyLoaded:function(){return Math.round(this.progress.body.loaded/this.progress.body.total*100)||0},qieBodyProgress:function(){return.82*this.progressBodyLoaded},qieBodyImage:function(){return 82===this.qieBodyProgress?__webpack_require__("21a4"):__webpack_require__("c2f4")},progressResourcesLoaded:function(){return Math.round(this.progress.resources.loaded/this.progress.resources.total*100)||0},qieResourcesProgress:function(){return.82*this.progressResourcesLoaded},qieResourcesImage:function(){return 82===this.qieResourcesProgress?__webpack_require__("21a4"):__webpack_require__("c2f4")},CROSS_ROBBERY:function(){return this.$store.state.user.CROSS_ROBBERY}},watch:{CROSS_ROBBERY:function(e){this.id!==e.id&&(this.formData.formData=e.formData.bodyDisable,this.formData.resourcesDisable=e.formData.resourcesDisable,this.progress.body.total=e.progress.body.total,this.progress.body.loaded=e.progress.body.loaded,this.progress.resources.total=e.progress.resources.total,this.progress.resources.loaded=e.progress.resources.loaded)}},mounted:function(){this.version=lib.version,this.newId()},methods:{newId:function(){this.id=Math.random().toString(16).slice(2)},handleSelectionChange:function(e){this.multipleSelection=e},updateFileResolve:function(){},dialogFileResolve:function(){this.formData.innerFileVisible=!1;var e=this.multipleSelection.map((function(e){return e.filename}));this.updateFileResolve(e)},sessionSave:function(){var e="CrossRobbery",_={id:this.id,formData:{formData:this.formData.bodyDisable,resourcesDisable:this.formData.resourcesDisable},progress:{body:{total:this.progress.body.total,loaded:this.progress.body.loaded},resources:{total:this.progress.resources.total,loaded:this.progress.resources.loaded}}};this.$store.dispatch(e,_)},add:function(e){e?this.progress.body.loaded+=Math.round(10*Math.random()):this.progress.body.loaded--},onmessage:function(e){var _=e.data;"methods"===_.type&&("checkUpdateForBody"===_.data?(this.formData.loading=!0,this.execCommand("body")):"checkUpdateForResources"===_.data&&(this.formData.loading=!0,this.execCommand("resources")))},execCommand:function(e,_){var t=this;if("body"===e){if(this.formData.bodyDisable&&!_)return this.$modal.msgWarning("请等待本体更新！");this.formData.bodyDisable=!0,this.getBodyUpdateInfo(_).then((function(e){t.$modal.msg("开始进行本体更新！"),t.getUpdateBodyFile(e).then((function(e){return t.progress.body.total=e.length,t.restMultiDownload(e,"body").then((function(e){return t.$modal.msgSuccess("本体渡劫成功!"),parent.lib.version=t.version,lib.version=t.version,!0}))}),(function(e){throw t.$modal.msgSuccess(e),e})).finally((function(){t.formData.bodyDisable=!1,t.sessionSave()}))})).catch((function(_){return t.requestDownloadError(_,e,!0)}))}else{if(this.formData.resourcesDisable&&!_)return this.$modal.msgWarning("请等待素材更新！");this.checkUpdateForResourceFile().then((function(e){t.formData.resourcesDisable=!0,t.getUpdateResourcesFile(e).then((function(e){return e=e.filter((function(e){return!0!==e})),e.length?(t.$modal.msg("开始进行素材更新！"),t.progress.resources.total=e.length,t.restMultiDownload(e,"resources").then((function(e){return t.$modal.msgSuccess("素材渡劫成功!"),game.saveConfig("asset_version",t.asset_version),!0}))):t.$modal.msgSuccess("素材已是最新版！")}),(function(e){throw t.$modal.msgSuccess(e),e})).finally((function(){t.formData.resourcesDisable=!1,t.sessionSave()}))})).catch((function(_){return t.requestDownloadError(_,e,!0)}))}},handleCommand:function(e){this.formData.checkForUpdate=e,this.execCommand(e)},restMultiDownload:function(e,_){var t=this;return console.log("restMultiDownload",e),this.multiDownload(e,_).then((function(e){var r=Object.keys(t.downloadFileError);return!(r.length>0)||t.restMultiDownload(r,_)}))},changeDownloadURL:function(e){var _=this;"https://raw.githubusercontent.com/libccy/noname/master/"===e&&this.$confirm("换成github需要挂vpn,否则无法进行更新，您确定已经挂vpn了吗？<br/>vpn自己准备","警告",{type:"error",lockScroll:!0,confirmButtonText:"确定",cancelButtonText:"取消",dangerouslyUseHTMLString:!0,closeOnClickModal:!0}).catch((function(e){var t;null===(t=_.$refs["elForm"].fields.find((function(e){return"downloadURL"===e.prop})))||void 0===t||t.resetField()}))},requestDownloadError:function(e,_,t){if([401,404,403,500].includes(e.status))return this.formData[_+"Disable"]=!1;var r="Network Error"===e.message;"string"===typeof e||r?(r?this.$modal.msgInfo(e.message+"：请检查网络环境"):this.$modal.msgSuccess(e.toString()),this.formData[_+"Disable"]=!1):this.execCommand(_,t)},getBodyUpdateInfo:function getBodyUpdateInfo(){var _this4=this;return this.formData.loading=!0,new Promise(function(){var _ref=Object(_Users_noname_UI_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_1__["a"])(Object(_Users_noname_UI_node_modules_babel_runtime_helpers_esm_regeneratorRuntime_js__WEBPACK_IMPORTED_MODULE_0__["a"])().mark((function _callee(resolve,reject){var update,files,version,version1,version2,i;return Object(_Users_noname_UI_node_modules_babel_runtime_helpers_esm_regeneratorRuntime_js__WEBPACK_IMPORTED_MODULE_0__["a"])().wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:return _context.next=2,Object(_components_Download_request__WEBPACK_IMPORTED_MODULE_26__["a"])("game/update.js",{baseURL:_this4.formData.downloadURL}).then((function(_ref2){var data=_ref2.data;return eval(data)}),(function(e){return _this4.$modal.msgInfo(e.message),reject(e)})).finally((function(){_this4.formData.loading=!1}));case 2:if(update=_context.sent,!Object(lodash_lang__WEBPACK_IMPORTED_MODULE_27__["isObject"])(update)){_context.next=29;break}if(game.saveConfig("check_version",update.version),files=null,version=_this4.version,update.version!==_this4.version){_context.next=9;break}return _context.abrupt("return",reject("当前版本已是最新"));case 9:if(!Object(lodash_lang__WEBPACK_IMPORTED_MODULE_27__["isArray"])(update.files)){_context.next=26;break}version1=version.split("."),version2=update.update.split("."),i=0;case 13:if(!(i<version1.length&&i<version2.length)){_context.next=25;break}if(!(version2[i]>version1[i])){_context.next=19;break}return files=!1,_context.abrupt("break",25);case 19:if(!(version1[i]>version2[i])){_context.next=22;break}return files=update.files.slice(0),_context.abrupt("break",25);case 22:i++,_context.next=13;break;case 25:null===files&&version1.length>=version2.length&&(files=update.files.slice(0));case 26:_this4.$confirm(update.changeLog.map((function(e){return"<li>".concat(e,"</li>")})).join(""),"有新版本".concat(update.version,"可用，是否下载？"),{type:"info",lockScroll:!0,closeOnClickModal:!1,dangerouslyUseHTMLString:!0,confirmButtonText:"更新",cancelButtonText:"放弃更新"}).then((function(){_this4.version=update.version,resolve(files)})).catch((function(e){_this4.$message({type:"warning",message:"取消更新"}),_this4.formData.bodyDisable=!1})),_context.next=30;break;case 29:reject(update);case 30:case"end":return _context.stop()}}),_callee)})));return function(e,_){return _ref.apply(this,arguments)}}())},checkUpdateForResourceFile:function checkUpdateForResourceFile(){var _this5=this;return Object(_Users_noname_UI_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_1__["a"])(Object(_Users_noname_UI_node_modules_babel_runtime_helpers_esm_regeneratorRuntime_js__WEBPACK_IMPORTED_MODULE_0__["a"])().mark((function _callee2(){var response,updates,skins,i,j;return Object(_Users_noname_UI_node_modules_babel_runtime_helpers_esm_regeneratorRuntime_js__WEBPACK_IMPORTED_MODULE_0__["a"])().wrap((function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return _this5.formData.loading=!0,_this5.errorRequestNumResources=0,_context2.next=4,Object(_components_Download_request__WEBPACK_IMPORTED_MODULE_26__["a"])("game/asset.js",{baseURL:_this5.formData.downloadURL}).then((function(_ref3){var data=_ref3.data;return eval(data)}),(function(e){throw _this5.$modal.msgInfo(e.message),e})).finally((function(){_this5.formData.loading=!1}));case 4:if(response=_context2.sent,Object(lodash_lang__WEBPACK_IMPORTED_MODULE_27__["isObject"])(response)||Object(lodash_lang__WEBPACK_IMPORTED_MODULE_27__["isArray"])(response)){_context2.next=7;break}throw response;case 7:if(window.noname_asset_list&&window.noname_skin_list){_context2.next=9;break}throw"没有资源列表";case 9:for(i in updates=window.noname_asset_list,delete window.noname_asset_list,skins=window.noname_skin_list,delete window.noname_skin_list,_this5.asset_version=updates.shift(),skins)for(j=1;j<=skins[i];j++)updates.push("image/skin/"+i+"/"+j+".jpg");if(updates.length){_context2.next=17;break}throw"暂无素材可更新！";case 17:return _context2.abrupt("return",updates);case 18:case"end":return _context2.stop()}}),_callee2)})))()},getUpdateBodyFile:function getUpdateBodyFile(files,isFinish){var _this6=this;return new Promise((function(resolve,reject){var success=function(){var _ref5=Object(_Users_noname_UI_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_1__["a"])(Object(_Users_noname_UI_node_modules_babel_runtime_helpers_esm_regeneratorRuntime_js__WEBPACK_IMPORTED_MODULE_0__["a"])().mark((function _callee3(_ref4){var data,updates,files2,_loop,i,_ret;return Object(_Users_noname_UI_node_modules_babel_runtime_helpers_esm_regeneratorRuntime_js__WEBPACK_IMPORTED_MODULE_0__["a"])().wrap((function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:if(data=_ref4.data,updates=eval(data),isFinish||!Object(lodash_lang__WEBPACK_IMPORTED_MODULE_27__["isArray"])(files)){_context3.next=15;break}files.push("game/update.js"),files2=[],_loop=function(e){var _=files[e].indexOf("*");if(-1===_)return i=e,"continue";_=files[e].slice(0,_),files.splice(e--,1),files2=files2.concat(updates.filter((function(e){return e.includes(_)}))),i=e},i=0;case 7:if(!(i<files.length)){_context3.next=14;break}if(_ret=_loop(i),"continue"!==_ret){_context3.next=11;break}return _context3.abrupt("continue",11);case 11:i++,_context3.next=7;break;case 14:updates=Array.from(new Set(files.concat(files2)));case 15:if(updates=updates.filter((function(e){return!(0===e.indexOf("theme/")&&!e.includes(".css"))&&!e.includes("node_modules")})),!isFinish){_context3.next=18;break}return _context3.abrupt("return",resolve({data:updates}));case 18:return _context3.next=20,_this6.openTableList(updates);case 20:return updates=_context3.sent,console.log("openTableList end updates:",updates),_context3.abrupt("return",resolve(updates));case 23:case"end":return _context3.stop()}}),_callee3)})));return function(e){return _ref5.apply(this,arguments)}}(),error=function(e){return 10===_this6.errorRequestNum++?(_this6.$message.error("多次请求未能成功！"),reject("error")):429===e.status?_this6.getUpdateBodyFile(files,!0).then((function(e){return success(e)})):reject(e)};Object(_components_Download_request__WEBPACK_IMPORTED_MODULE_26__["a"])("game/source.js",{baseURL:_this6.formData.downloadURL}).then(success,error).catch((function(e){_this6.$message.error("文件内容不对，无法成功执行内容!"),reject(e)}))}))},openTableList:function(e){var _=this;return console.log("openTableList before updateFileList:",e),new Promise((function(t){_.formData.innerFileVisible=!0,_.updateFileList=e.map((function(e){return{filename:e,label:e.endsWith("config.js")?"".concat(e,"    懒人包不建议更新"):e}})),_.$nextTick((function(){_.$refs.multipleTable.toggleAllSelection()})),_.updateFileResolve=t}))},checkReadFile:function(e){return new Promise((function(_,t){window.requestAnimationFrame((function(t){var r,s;null!==(r=lib)&&void 0!==r&&null!==(s=r.node)&&void 0!==s&&s.fs?lib.node.fs.access("".concat(parent.__dirname,"/").concat(e),lib.node.fs.constants.R_OK,(function(t){return _(!t||e)})):parent.resolveLocalFileSystemURL("".concat(lib.assetURL).concat(e),(function(e){return _(!0)}),(function(t){return _(e)}))}))}))},getUpdateResourcesFile:function(e){var _=this;return Object(_Users_noname_UI_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_1__["a"])(Object(_Users_noname_UI_node_modules_babel_runtime_helpers_esm_regeneratorRuntime_js__WEBPACK_IMPORTED_MODULE_0__["a"])().mark((function t(){return Object(_Users_noname_UI_node_modules_babel_runtime_helpers_esm_regeneratorRuntime_js__WEBPACK_IMPORTED_MODULE_0__["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",Promise.all(Object(_Users_noname_UI_node_modules_babel_runtime_helpers_esm_toConsumableArray_js__WEBPACK_IMPORTED_MODULE_2__["a"])(e.map((function(e){return _.checkReadFile(e)})))));case 1:case"end":return t.stop()}}),t)})))()},then:function(e){var _=e.data,t=e.filename,r=e.filepath,s=e.filefullname,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"body",a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n="Too Many Requests"===_||function(e){return e&&0===String(e).indexOf("Too Many Requests")}(_);a&&(n=!0),n?this.downloadFileError[s]=!0:(this.progress[o].loaded++,delete this.downloadFileError[s],this.sessionSave());var i=this.downloadFiles[s];return i?(i.num++,i.isSuccess=!n):i=this.downloadFiles[s]={data:_,filename:t,filepath:r,filefullname:s,isSuccess:!n,num:1},i},catch:function(e){var _=this.downloadFileError[e.filefullname]||1;return this.downloadFileError[e.filefullname]=++_,Promise.resolve(!1)},multiDownload:function(e,_){var t=this,r=e.map((function(e){return"".concat(t.formData.downloadURL).concat(e)}));return Object(_components_Download_multiDownload__WEBPACK_IMPORTED_MODULE_28__["a"])(r,(function(e,r){return Object(_components_Download_request__WEBPACK_IMPORTED_MODULE_26__["a"])(r).then((function(e){return t.then(e,_)}))}),(function(e,r,s){var o={filename:s,filefullname:r.replace(t.formData.downloadURL,""),data:e.message};return o.filepath=o.filefullname.replace(s,""),t.then(o,_,!0)}),(function(e){return e.replace(t.formData.downloadURL,"")}))},handleAdd:function handleAdd(){var _this10=this;this.$refs["elForm"].validate((function(valid){valid&&(_this10.formData.handleAddLoading=!0,_this10.$nextTick((function(){new Promise((function(resolve,reject){Object(_components_Download_request__WEBPACK_IMPORTED_MODULE_26__["a"])("game/update.js",{baseURL:_this10.addFormData.value}).then((function(_ref7){var data=_ref7.data;if(eval(data),!window.noname_update)throw new Error("未找到对应的资源列表");var downloadURLOptions=_this10.formData.downloadURLOptions;if(_this10.formData.updateInputLabelDisable){var downloadURL=downloadURLOptions.find((function(e){var _=e.label;return _===_this10.addFormData.label}));downloadURL.value=_this10.addFormData.value}else downloadURLOptions.push(_this10.addFormData);_this10.$cache.local.setJSON("download - options",downloadURLOptions),resolve(!0)})).catch((function(e){console.error(e),resolve(e.message)}))})).then((function(e){_this10.formData.innerVisible=!0!==e,_this10.$modal[!0===e?"msgSuccess":"msgInfo"](!0===e?"保存成功":e,{dangerouslyUseHTMLString:!0})})).finally((function(){_this10.formData.handleAddLoading=!1}))})))}))},checkDownloadLabelUnique:function(e,_,t){var r=this.formData.downloadURLOptions.concat(this.downloadURLOptions);!1===this.formData.updateInputLabelDisable&&r.find((function(e){return e.label.trim()===_.trim()}))?t(new Error(e.message)):t()},checkDownloadValueUnique:function(e,_,t){var r=this.formData.downloadURLOptions.concat(this.downloadURLOptions);!1===this.formData.updateInputLabelDisable&&r.find((function(e){return e.value.trim()===_.trim()}))?t(new Error(e.message)):t()},handleUpdate:function(e){this.formData.innerVisible=!0,this.addFormData=e,this.formData.updateInputLabelDisable=!0},handleDelete:function(e){var _=e.label,t=this.formData.downloadURLOptions,r=t.findIndex((function(e){return e.label===_}));t.splice(r,1),this.$cache.local.setJSON("download - options",t)}},beforeDestroy:function(){window.removeEventListener("message",this.onmessage)}}},3640:function(e,_,t){"use strict";t.d(_,"a",(function(){return n}));var r=t("2909"),s=t("c7eb"),o=t("1da1"),a=(t("14d9"),t("fb6a"),t("d3b7"),t("3ca3"),t("ddb0"),t("99af"),t("d81d"),{});function n(e,_,t,r){return i.apply(this,arguments)}function i(){return i=Object(o["a"])(Object(s["a"])().mark((function e(_,t,r,o){var a,n;return Object(s["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=[],_.length<=3?a.push(l(_,t,r,o)):(n=Math.round(_.length/3),a.push(l(_.slice(0,n),t,r,o)),a.push(l(_.slice(n,2*n),t,r,o)),a.push(l(_.slice(2*n),t,r,o))),e.abrupt("return",Promise.all([].concat(a)));case 3:case"end":return e.stop()}}),e)}))),i.apply(this,arguments)}function l(e,_,t,r){return c.apply(this,arguments)}function c(){return c=Object(o["a"])(Object(s["a"])().mark((function e(_,t,o,n){var i;return Object(s["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return i=_.map((function(e,r){return new Promise((function(s){var i;i="function"==typeof n?n(e):e;var l=a[i];l&&clearTimeout(l),setTimeout((function(){game.download(e,i,(function(){clearTimeout(a[i]),s(!t||t(e,i,_.length))}),(function(_){s(!!o&&o(_,e,i))}))}),10*r)}))})),e.abrupt("return",Promise.all(Object(r["a"])(i)));case 2:case"end":return e.stop()}}),e)}))),c.apply(this,arguments)}},c2f4:function(e,_,t){e.exports=t.p+"static/img/qie_loding.fa450cd6.gif"}}]);