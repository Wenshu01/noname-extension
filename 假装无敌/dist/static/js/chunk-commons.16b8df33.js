(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-commons"],{"347b":function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("codemirror",{ref:"myCm",staticStyle:{height:"100%"},attrs:{value:e.editorValue,options:e.cmOptions},on:{changes:e.onCmCodeChanges,blur:e.onCmBlur},nativeOn:{keydown:function(t){return e.onKeyDown(t)},mousedown:function(t){return e.onMouseDown(t)},paste:function(t){return e.OnPaste(t)}}})},r=[],o=n("53ca"),a=(n("d3b7"),n("25f0"),n("e9c4"),n("8f94")),s=(n("a7be"),n("6d78"),n("6a70"),n("7393"),n("f9d4"),n("d5e0"),n("d69f"),n("7b00"),n("ced0"),n("ffda"),n("959b"),n("f6b6"),n("9b74"),n("3c98"),n("2768"),n("111b"),n("92f1"),n("991c"),n("832b"),n("0dd0"),n("8822"),n("d2de"),n("18d1"),n("c434"),n("fedc"),n("4895"),n("cbc8"),n("697eb"),n("aedd"),n("a2c1"),n("164b"),n("9f09"),n("8d70"),n("10b2"),n("05dd"),n("8f0a"),n("8c33"),n("31c5"),n("18fe6"),n("2aed"),n("d72f"),n("b933"),n("0b6c"),n("f4ba"),n("d800")),c=n.n(s),l=n("d3c5"),u=n.n(l);window.JSHINT=c.a.JSHINT,window.CSSLint=u.a.CSSLint;var h={components:{codemirror:a["codemirror"]},props:["cmTheme","cmMode","autoFormatJson","jsonIndentation","lintOptions","newValue"],data:function(){var e=this;return{editorValue:this.newValue||"",cmOptions:{viewportMargin:20,theme:this.cmTheme&&"default"!==this.cmTheme?this.cmTheme:"blackboard",mode:this.cmMode&&"default"!==this.cmMode?this.cmMode:"javascript",lineWrapping:!0,lineNumbers:!0,autofocus:!0,smartIndent:!0,autocorrect:!0,spellcheck:!0,showCursorWhenSelecting:!0,extraKeys:{Ctrl:"autocomplete","Ctrl-Shift-F":function(){try{"application/json"===e.cmOptions.mode&&e.editorValue&&(e.editorValue=e.formatStrInJson(e.editorValue))}catch(t){e.$message.error("格式化代码出错："+t.toString())}},F11:"fullScreen"},lint:!0,gutters:["CodeMirror-lint-markers","CodeMirror-linenumbers","CodeMirror-foldgutter"],foldGutter:!0,autoCloseBrackets:!0,autoCloseTags:!0,matchTags:{bothTags:!0},matchBrackets:!0,styleActiveLine:!1,autoRefresh:!0,highlightSelectionMatches:{minChars:2,style:"matchhighlight",showToken:!0},styleSelectedText:!0,enableAutoFormatJson:!1,defaultJsonIndentation:!1},enableAutoFormatJson:!1,defaultJsonIndentation:!1}},watch:{cmTheme:function(e,t){try{var i="default"===this.cmTheme?"blackboard":this.cmTheme;n("0419")("./"+i+".css"),this.cmOptions.theme=i,this.resetLint()}catch(r){this.$message.error("切换编辑器主题出错："+r.toString())}},cmMode:function(e,t){this.$set(this.cmOptions,"mode",this.cmMode),this.resetLint(),this.resetFoldGutter()}},methods:{resetLint:function(){var e=this;this.$refs.myCm.codemirror.getValue()?(this.$refs.myCm.codemirror.setOption("lint",this.lintOptions),this.$nextTick((function(){e.$refs.myCm.codemirror.setOption("lint",e.lintOptions)}))):this.$nextTick((function(){e.$refs.myCm.codemirror.setOption("lint",!1)}))},resetFoldGutter:function(){var e=this;this.$refs.myCm.codemirror.setOption("foldGutter",!1),this.$nextTick((function(){e.$refs.myCm.codemirror.setOption("foldGutter",!0)}))},setStyle:function(e){var t=this;try{this.$nextTick((function(){var n=t.$refs.myCm.$el.querySelector(".CodeMirror");n?n.style.cssText=e:t.$message.error("未找到编辑器元素，修改编辑器样式失败")}))}catch(n){this.$message.error("修改编辑器样式失败："+n.toString())}},getValue:function(){try{return this.$refs.myCm.codemirror.getValue()}catch(t){var e=t.toString();return this.$message.error("获取编辑框内容失败："+e),e}},setValue:function(e){try{if(Object(o["a"])(e)!==Object(o["a"])(""))return void this.$message.error("修改编辑框内容失败：编辑宽内容只能为字符串");"application/json"===this.cmOptions.mode?this.editorValue=this.formatStrInJson(e):this.editorValue=e}catch(t){this.$message.error("修改编辑框内容失败："+t.toString())}},OnPaste:function(e){},onCmBlur:function(e,t){},onKeyDown:function(e){var t=e.keyCode||e.which||e.charCode,n=e.ctrlKey||e.altKey||e.metaKey;!n&&t>64&&t<123&&this.$refs.myCm.codemirror.showHint({completeSingle:!1})},onMouseDown:function(e){this.$refs.myCm.codemirror.closeHint()},onCmCodeChanges:function(e,t){this.editorValue=e.getValue(),this.resetLint()},formatStrInJson:function(e){return JSON.stringify(JSON.parse(e),null,this.defaultJsonIndentation)},execCommand:function(e){this.$refs.myCm.codemirror.execCommand(e)}},created:function(){try{this.editorValue||(this.cmOptions.lint=!1)}catch(e){console.log("初始化codemirror出错："+e)}}},m=h,d=(n("f7e5"),n("2877")),f=Object(d["a"])(m,i,r,!1,null,null,null);t["a"]=f.exports},4478:function(e,t,n){},"5e84":function(e,t,n){},"8a8d":function(e,t,n){"use strict";n("4478")},"9d59":function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"app-container"},[e.showSearch?n("el-form",{ref:"queryForm",attrs:{model:e.queryParams,inline:!0,"label-width":"50px"},nativeOn:{submit:function(e){e.preventDefault()}}},[n("el-form-item",{attrs:{label:"搜索",prop:"searchName"}},[n("el-input",{staticStyle:{width:"240px"},attrs:{placeholder:"支持拼音，模糊请用 空格 分离",clearable:"",size:"small"},on:{change:function(t){e.queryParams.search=e.queryParams.search.trim()}},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:(t.stopPropagation(),t.preventDefault(),e.querySearch(t))}},model:{value:e.queryParams.search,callback:function(t){e.$set(e.queryParams,"search",t)},expression:"queryParams.search"}})],1),"skill"!==e.$props.libCodeStr?n("el-form-item",{attrs:{"label-width":"70px",label:"所属包",prop:"searchPack"}},[n("el-select",{attrs:{placeholder:"请选择"},on:{change:e.initFuse},model:{value:e.pack,callback:function(t){e.pack=t},expression:"pack"}},e._l(e.packs,(function(t){return n("el-option",{key:t.value,staticStyle:{width:"100%",height:"100%"},attrs:{label:t.label,value:t.value}},[n("span",{domProps:{innerHTML:e._s(t.label)}})])})),1)],1):e._e(),n("el-form-item",[n("el-button",{attrs:{type:"primary",icon:"el-icon-search",size:"small"},on:{click:e.querySearch}},[e._v("搜索")]),n("el-button",{attrs:{type:"primary",icon:"el-icon-s-tools",size:"small"},on:{click:function(t){e.openWeight=!e.openWeight}}},[e._v("设置权重")])],1)],1):e._e(),n("right-toolbar",{attrs:{showSearch:e.showSearch,columns:e.columns},on:{"update:showSearch":function(t){e.showSearch=t},"update:show-search":function(t){e.showSearch=t},queryTable:e.getList}}),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.dataList,stripe:"","highlight-current-row":"","empty-text":"无"}},[e.columns[0].visible?n("el-table-column",{attrs:{label:e.columns[0].label,align:"center",prop:"key"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("div",{staticStyle:{all:"inherit"},domProps:{innerHTML:e._s(t.row.key)}})]}}],null,!1,812620258)}):e._e(),e.columns[1].visible?n("el-table-column",{attrs:{label:e.columns[1].label,align:"center",prop:"name"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("div",{staticStyle:{all:"inherit"},domProps:{innerHTML:e._s(t.row.name)}})]}}],null,!1,3288923954)}):e._e(),e.columns[2].visible?n("el-table-column",{attrs:{label:e.columns[2].label,align:"center",prop:"pinyin"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("div",{staticStyle:{all:"inherit"},domProps:{innerHTML:e._s(t.row.pinyin)}})]}}],null,!1,2808384892)}):e._e(),e.columns[3].visible?n("el-table-column",{attrs:{label:e.columns[3].label,align:"center",prop:"findCardPack"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("div",{staticStyle:{all:"inherit"},domProps:{innerHTML:e._s(t.row.findPack)}})]}}],null,!1,2705376201)}):e._e(),e.columns[4].visible?n("el-table-column",{attrs:{label:e.columns[4].label,align:"center",prop:"info","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(t){return[n("div",{staticStyle:{all:"inherit"},domProps:{innerHTML:e._s(t.row.info)}})]}}],null,!1,1124899899)}):e._e(),e.columns[5].visible?n("el-table-column",{attrs:{label:e.columns[5].label,align:"center","class-name":"small-padding fixed-width",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.columns[5].rate?n("el-rate",{on:{change:function(n){return e.columns[5].rate(n,t.row)}},model:{value:t.row.rateValue,callback:function(n){e.$set(t.row,"rateValue",n)},expression:"scope.row.rateValue"}}):n("div",[n("el-link",{attrs:{type:"primary"},on:{click:function(n){return e.showInfoCode(t.row,!0)}}},[n("i",{staticClass:"el-icon-view el-icon--right"}),e._v("打开代码页 ")])],1)]}}],null,!1,1322438242)}):e._e()],1),n("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.queryParams.pageNum,limit:e.queryParams.pageSize},on:{"update:page":function(t){return e.$set(e.queryParams,"pageNum",t)},"update:limit":function(t){return e.$set(e.queryParams,"pageSize",t)},pagination:e.getList}}),n("el-dialog",{attrs:{title:e.title,visible:e.open,"custom-class":"hidden-header",fullscreen:"","append-to-body":""},on:{"update:visible":function(t){e.open=t}}},[n("MyCodemirrorEdit",{ref:"myCodemirrorEdit",attrs:{editorValue:e.code}})],1),n("el-dialog",{attrs:{title:"设置权重",visible:e.openWeight,"append-to-body":""},on:{"update:visible":function(t){e.openWeight=t}}},[n("el-form",{attrs:{inline:!0,"label-width":"68px"},nativeOn:{submit:function(e){e.preventDefault()}}},[n("el-form-item",{staticStyle:{display:"block","font-size":"20px"}},[n("b",[e._v("权重越高，其相关性得分越高,为0则不进行搜索,若设置多个权重则模糊搜索至少匹配一项")])]),e._l(e.weight,(function(t){return n("el-form-item",{key:t.key,attrs:{label:t.label}},[n("el-input-number",{staticStyle:{width:"240px"},attrs:{min:0,max:10,size:"small"},model:{value:t.value,callback:function(n){e.$set(t,"value",n)},expression:"item.value"}})],1)}))],2),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary"},on:{click:e.submitWightForm}},[e._v("确 定")]),n("el-button",{on:{click:function(t){e.openWeight=!1}}},[e._v("取 消")])],1)],1)],1)},r=[],o=n("c7eb"),a=n("1da1"),s=(n("4ec9"),n("d3b7"),n("3ca3"),n("ddb0"),n("d81d"),n("b64b"),n("ac1f"),n("5319"),n("99af"),n("b0c0"),n("4de4"),n("a15b"),n("841c"),n("4d63"),n("c607"),n("2c3e"),n("25f0"),n("caad"),n("2532"),n("9767"),n("fb6a"),n("498a"),n("159b"),n("14d9"),n("e9c4"),n("0278")),c=n.n(s),l=n("aa62"),u=n.n(l),h=n("8417"),m=n("c38a");function d(e){return"无"}var f={name:"Search",components:{MyCodemirrorEdit:h["default"]},props:{name:{type:String,default:""},columns:{type:Array,default:[]},libCodeStr:{type:String,default:"card"},getPackInfo:{type:Function,default:d},weightOptions:{type:Array,default:[]}},data:function(){return{pack:"",packs:[],weight:this.weightOptions,code:"",loading:!0,showSearch:!0,total:0,dataList:[],title:"",open:!1,openWeight:!1,queryParams:{search:"",pageNum:1,pageSize:10},fuse:void 0,catchFuses:new Map,catchList:new Map,searchList:[]}},created:function(){var e=this;return Object(a["a"])(Object(o["a"])().mark((function t(){var n,i;return Object(o["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getLocalData("".concat(e.AsName," - weight"));case 2:n=t.sent,i=n.data,null!==i&&(e.weight=i),e.packs=function(){var t=lib[e.libCodeStr+"Pack"];return t?Object.keys(t).map((function(t){return{label:get.translation("".concat(t,"_").concat(e.libCodeStr,"_config")).replace(/<[^>]+>/g,""),value:t}})):[]}(),e.lib?(e.initFuse(),e.$modal.msgSuccess("加载完毕，请开始使用"),e.loading=!1):e.postMessage({type:"get",data:"lib"});case 7:case"end":return t.stop()}}),t)})))()},computed:{theme:function(){return this.$store.state.settings.theme},lib:function(){return this.$store.state.user.lib},AsName:function(){return this.name+"Search"},weights:function(){return this.weight.filter((function(e){return e.value>0})).map((function(e){return e.key}))}},watch:{lib:function(e){e&&(this.loading=!0,this.initFuse(),this.$modal.msgSuccess("加载完毕，请开始使用"),this.loading=!1)},searchList:function(e){var t=this;this.loading=!0;var n=this.queryParams.search.replace(/\s+/g,"").split("").join("|");try{new RegExp(n,"gim")}catch(i){this.$modal.msgInfo("非法字符，请不要输入正则表达式的字符！"+i.toString()),this.list=[]}setTimeout((function(){if(!e.length)return t.dataList=[],t.total=0,void(t.loading=!1);var i=(t.queryParams.pageNum-1)*t.queryParams.pageSize,r=e;""!==t.queryParams.search&&(r=r.map((function(e){return e.item})).map((function(e){var i={};for(var r in e)e.hasOwnProperty(r)&&"string"===typeof e[r]&&("sourceKey"!==r&&t.weights.includes(r)?i[r]=e[r].replace(new RegExp(n,"gim"),(function(e,n,i){return e.fontcolor(t.theme)})):i[r]=e[r]);return i}))),t.dataList=r.slice(i,i+t.queryParams.pageSize).map((function(e){var n,i;return e.findPack=t.getPackInfo(e.sourceKey),e.rateValue=(null===(n=t.columns[5])||void 0===n?void 0:n.getRateNum)&&(null===(i=t.columns[5])||void 0===i?void 0:i.getRateNum(e.sourceKey))||1,e.rateValue*=1,e})),t.loading=!1}),150)}},methods:{initFuse:function(){var e=this.generateCode(lib[this.libCodeStr]),t=this.weight.filter((function(e){return e.value>0})).map((function(e){return{name:e.key,weight:e.value/10}}));this.fuse=new c.a(e,{shouldSort:!0,threshold:.6,location:0,distance:100,maxPatternLength:32,findAllMatches:!0,minMatchCharLength:1,keys:t})},search:function(){var e=this,t=this.queryParams.search;if(this.pack&&""===t.trim()&&this.catchList.has(this.pack))return this.catchList.get(this.pack).map((function(e){return e.sourceKey=e.key,e}));var n=this.queryParams.search.split(" ");return n.length>1&&(t={$or:n.map((function(t){var n={};return e.weight.filter((function(e){return e.value>0})).forEach((function(e){n[e.key]=t})),n}))}),this.fuse.search(t)},generateCode:function(e){var t=this;return Object.keys(e).map((function(e){return{key:e,name:get.translation(e),pinyin:u.a.convertToPinyinString(get.translation(e),"",u.a.WITHOUT_TONE),info:function(){var n="character"===t.libCodeStr?get.characterIntro(e):get.translation(e,"info");return"string"===typeof n?n:(null===n||void 0===n?void 0:n.toString)&&n.toString()||"莫得描述"}(),sourceKey:e}}))},getList:function(){this.loading=!0,this.searchList=this.search(),this.loading=!1},cancel:function(){this.open=!1},querySearch:function(){if(void 0===this.fuse)return this.$modal.msgInfo("请耐心等待初始化！");this.loading=!0,this.queryParams.pageNum=1;var e=this.search();this.searchList=e,this.total=e.length,this.loading=!1},setInfoCode:function(e){return this.code="lib.".concat(this.libCodeStr,".").concat(e.sourceKey," = ").concat(get.stringify(Object(m["c"])(lib[this.libCodeStr][e.sourceKey]))),this.code},showInfoCode:function(e,t){var n=this;this.setInfoCode(e),t||(this.open=!0,this.$nextTick((function(){n.$refs.myCodemirrorEdit.onEditorModeChange("javascript"),n.$refs.myCodemirrorEdit.setValue(n.code)}))),t&&this.$router.push({name:"CodemirrorShowCode",params:{newValue:this.code}})},submitWightForm:function(){var e=this;this.openWeight=!1,this.initFuse(),this.setItem("".concat(this.AsName," - weight"),this.weight).then((function(t){return e.$modal.msgSuccess("设置权重成功")}))},submitForm:function(){console.log(this.weight,JSON.stringify(this.weight))}}},p=f,g=(n("8a8d"),n("2877")),y=Object(g["a"])(p,i,r,!1,null,null,null);t["a"]=y.exports},f7e5:function(e,t,n){"use strict";n("5e84")}}]);